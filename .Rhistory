companies <- read.csv("indian_companies_transformed.csv", skipNul = TRUE)
data = companies[, c("logREVIEWS", "logRATING", "logBRANCHES", "YEARS.OLD", "INDUSTRY", "INDIA.HQ", "TOTAL_EMPLOYEES", "logPACKAGE")]
data$INDUSTRY = factor(data$INDUSTRY)
data$INDIA.HQ = factor(data$INDIA.HQ)
lmod = lm(logPACKAGE ~ ., data)
summary(lmod)
X = model.matrix(lmod)
cat_vars = c("YEARS.OLD","logRATING","logREVIEWS","logBRANCHES","TOTAL_EMPLOYEES")
pairs(data[cat_vars], labels = cat_vars, main="Pairwise scatter plot of data")
cat("Correlation Matrix:\n")
cor(X[, c(2, 19, 20, 21, 22)])
n = dim(X)[1]
p = dim(X)[2]
XtX = t(X)%*%X
lambda = eigen(XtX)$values
cat("\u03BB =", lambda)
K = sqrt(lambda[1]/lambda[p])
cat("Condition number is given by K = ", K)
library(faraway)
v = vif(lmod)
print(v)
cat("Average VIF for predictors: ", sum(v)/p)
cat("Maximum value of VIF: ", max(v))
null = lm(logPACKAGE ~ 1, na.omit(data))
full = lm(logPACKAGE ~ ., na.omit(data))
out = step(null, scope = list(lower=~1, upper=formula(full)), direction = "both", trace = FALSE)
cat("Order of parameters: ",out$anova[,1])
plot(out$anova[,6], xlab="Number of Params", ylab="AIC", main="AIC vs p")
out = step(null, scope = list(lower=~1, upper=formula(full)), direction = "both", k=log(n), trace = FALSE)
cat("Order of parameters:", out$anova[,1])
cat("Adjusted R-squared: ", summary(out)$adj.r.squared)
x_new = data.frame(logREVIEWS = log(10000), logBRANCHES = log(5), logRATING=log(3),
INDIA.HQ=factor("Bangalore / Bengaluru", levels = levels(data$INDIA.HQ)),
INDUSTRY=factor("IT Services & Consulting", levels = levels(data$INDUSTRY)))
y = predict(out, newdata = x_new)
cat("Average monthly package predicted: ", round(exp(y), 2), "L")
x_new = data.frame(logREVIEWS = log(10000), logBRANCHES = log(5), logRATING=log(3),
INDIA.HQ=factor("Bangalore / Bengaluru", levels = levels(data$INDIA.HQ)),
INDUSTRY=factor("Education & Training", levels = levels(data$INDUSTRY)))
y = predict(out, newdata = x_new)
cat("Average monthly package predicted: ", round(exp(y), 2), "L")
summary(out)
