---
title: "PLOTS"
output:
  pdf_document:
    latex_engine: xelatex
  html_document:
    df_print: paged
---
```{r, echo=FALSE, message=FALSE, warning=FALSE}

 
# 1. LOAD CLEAN DATA
 

model_data <- read.csv("../data/indian_companies_processed.csv",
                       stringsAsFactors = FALSE)

numeric_cols <- model_data[, c(
  "PACKAGE",
  "RATING",
  "REVIEWS",
  "YEARS.OLD",
  "BRANCHES",
  "TOTAL_EMPLOYEES"
)]


 
# 2. PAIRWISE SCATTERPLOT MATRIX
 

pairs(numeric_cols, 
      main = "Pairwise Scatterplot Matrix")


 
# 3. INDIVIDUAL SCATTER PLOTS
 

plot(model_data$RATING, model_data$PACKAGE,
     main = "Rating vs Package",
     xlab = "Rating", ylab = "Package",
     pch = 19, col = "blue")

plot(model_data$REVIEWS, model_data$PACKAGE,
     main = "Reviews vs Package",
     xlab = "Reviews", ylab = "Package",
     pch = 19, col = "darkgreen")

plot(model_data$BRANCHES, model_data$PACKAGE,
     main = "Branches vs Package",
     xlab = "Branches", ylab = "Package",
     pch = 19, col = "red")

plot(model_data$YEARS.OLD, model_data$PACKAGE,
     main = "Company Age vs Package",
     xlab = "Company Age (Years)", ylab = "Package",
     pch = 19, col = "purple")

plot(model_data$TOTAL_EMPLOYEES, model_data$PACKAGE,
     main = "Employees vs Package",
     xlab = "Total Employees", ylab = "Package",
     pch = 19, col = "orange")



 
# NOTE:
# The scatterplots show that RATING, REVIEWS, and BRANCHES
# (RRB) have strong non-linear patterns — data is heavily
# right-skewed → values clustered near zero.
#
# Because of this nonlinearity, we apply log-scale in 
# histograms & density plots to make patterns visible.
 



 
# 4.HISTOGRAMS 
 

par(mfrow = c(2,3), mar = c(4,4,3,1))

cols <- c("#1f77b4", "#ff7f0e", "#2ca02c",
          "#d62728", "#9467bd", "#8c564b")

i <- 1
for (col in names(numeric_cols)) {

  x <- numeric_cols[[col]]

  # Log-scale for nonlinear / heavily skewed variables (RRB)
  if (col %in% c("PACKAGE", "REVIEWS", "BRANCHES", "RATING")) {
    x <- log10(x + 0.01)
    xlabel <- paste(col, " (log scale)")
  } else {
    xlabel <- col
  }

  hist(x,
       main = paste("Histogram:", col),
       xlab = xlabel,
       col = adjustcolor(cols[i], 0.6),
       border = "white")

  grid(col = "gray85")
  i <- i + 1
}

par(mfrow = c(1,1))



 
# 5.density plots
 

par(mfrow = c(2,3), mar = c(7,7,4,2))

i <- 1
for (col in names(numeric_cols)) {

  x <- numeric_cols[[col]]

  # Log-scale only for variables showing nonlinear patterns (RRB)
  if (col %in% c("PACKAGE", "REVIEWS", "BRANCHES", "RATING")) {
    x <- log10(x + 0.01)
    xlabel <- paste(col, "(log scale)")
  } else {
    xlabel <- col
  }

  plot(density(x, na.rm = TRUE),
       main = paste("Density:", col),
       xlab = xlabel,
       lwd = 3,
       col = adjustcolor(cols[i], 0.9),
       panel.first = grid(col = "gray90"))

  i <- i + 1
}

par(mfrow = c(1,1))



 
# 6. BOXPLOTS (two different styles)
 

# Boxplot 1 — Industry 

par(mar = c(8, 5, 4, 2) + 0.1)   # bottom, left, top, right margins
boxplot(log(PACKAGE) ~ INDUSTRY,
        data = model_data,
        main = "(Package) vs Industry",
        las = 2,
        col = "lightblue",
        border = "blue",
        notch = TRUE,
        xlab = " ",
        ylab = "Package"
)

grid(nx = NA, ny = NULL, col = "gray85")



# Boxplot 2 — Headquarters 



cols2 <- c("tomato", "gold", "springgreen3", "skyblue")

boxplot(model_data$PACKAGE ~ model_data$INDIA.HQ,
        main = "Package vs Headquarters",
        las = 2,
        col = cols2,
        border = "black",
        boxwex = 0.7,
        outline = FALSE,
        ylab = "Package (Lakhs)",
        xlab = " ")


```